<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Animated Grid Background with Cards</title>
<!-- Add Solana Web3.js -->
<script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    overflow-x: hidden;
  }

  .container {
    width: 100%;
    min-height: 200vh;
    --color: rgba(114, 114, 114, 0.3);
    background-color: #191a1a;
    background-image:
      linear-gradient(0deg, transparent 24%, var(--color) 25%, var(--color) 26%, transparent 27%, transparent 74%, var(--color) 75%, var(--color) 76%, transparent 77%, transparent),
      linear-gradient(90deg, transparent 24%, var(--color) 25%, var(--color) 26%, transparent 27%, transparent 74%, var(--color) 75%, var(--color) 76%, transparent 77%, transparent);
    background-size: 55px 55px;
    animation: gridMove 6s linear infinite;
    position: relative;
    overflow: hidden;
  }

  @keyframes gridMove {
    from { background-position: 0 0; }
    to   { background-position: 0 55px; }
  }

  .container::after {
    content: "";
    position: fixed;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 120%;
    height: 180px;
    background: radial-gradient(ellipse at bottom, rgba(255, 255, 255, 0.55), rgba(255, 255, 255, 0.15) 40%, transparent 80%);
    filter: blur(40px);
    pointer-events: none;
    z-index: 1;
  }

  .loader {
    --main-size: 10em;
    --text-color: #ffffff;
    --shine-color: #ffffff40;
    --shadow-color: #aaaaaa;
    position: absolute;
    top: 12%;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    justify-content: center;
    align-items: center;
    width: 7.3em;
    height: 1em;
    font-size: var(--main-size);
    font-weight: 1000;
    text-transform: uppercase;
    user-select: none;
    filter: drop-shadow(0 0 0.05em var(--shine-color));
    z-index: 2;
  }

  .loader .text {
    display: flex;
    align-items: center;
    justify-content: center;
    white-space: nowrap;
    overflow: hidden;
    position: absolute;
    text-align: center;
  }

  .loader .text:nth-child(1) { clip-path: polygon(0% 0%, 11.11% 0%, 11.11% 100%, 0% 100%); font-size: calc(var(--main-size)/20); margin-left:-2.1em; opacity:0.6; }
  .loader .text:nth-child(2) { clip-path: polygon(11.11% 0%, 22.22% 0%, 22.22% 100%, 11.11% 100%); font-size: calc(var(--main-size)/16); margin-left:-0.98em; opacity:0.7; }
  .loader .text:nth-child(3) { clip-path: polygon(22.22% 0%, 33.33% 0%, 33.33% 100%, 22.22% 100%); font-size: calc(var(--main-size)/13); margin-left:-0.33em; opacity:0.8; }
  .loader .text:nth-child(4) { clip-path: polygon(33.33% 0%, 44.44% 0%, 44.44% 100%, 33.33% 100%); font-size: calc(var(--main-size)/11); margin-left:-0.05em; opacity:0.9; }
  .loader .text:nth-child(5) { clip-path: polygon(44.44% 0%, 55.55% 0%, 55.55% 100%, 44.44% 100%); font-size: calc(var(--main-size)/10); margin-left:0em; opacity:1; }
  .loader .text:nth-child(6) { clip-path: polygon(55.55% 0%, 66.66% 0%, 66.66% 100%, 55.55% 100%); font-size: calc(var(--main-size)/11); margin-left:0.05em; opacity:0.9; }
  .loader .text:nth-child(7) { clip-path: polygon(66.66% 0%, 77.77% 0%, 77.77% 100%, 66.66% 100%); font-size: calc(var(--main-size)/13); margin-left:0.33em; opacity:0.8; }
  .loader .text:nth-child(8) { clip-path: polygon(77.77% 0%, 88.88% 0%, 88.88% 100%, 77.77% 100%); font-size: calc(var(--main-size)/16); margin-left:0.98em; opacity:0.7; }
  .loader .text:nth-child(9) { clip-path: polygon(88.88% 0%, 100% 0%, 100% 100%, 88.88% 100%); font-size: calc(var(--main-size)/20); margin-left:2.1em; opacity:0.6; }

  .loader .text span {
    animation: scrolling 2s cubic-bezier(0.1, 0.6, 0.9, 0.4) infinite, shadow 2s cubic-bezier(0.1, 0.6, 0.9, 0.4) infinite;
  }

  .loader .text:nth-child(1) span { background: linear-gradient(to right, var(--text-color)4%, var(--shadow-color)7%); background-size:200% auto; background-clip:text; color:transparent; }
  .loader .text:nth-child(2) span { background: linear-gradient(to right, var(--text-color)9%, var(--shadow-color)13%); background-size:200% auto; background-clip:text; color:transparent; }
  .loader .text:nth-child(3) span { background: linear-gradient(to right, var(--text-color)15%, var(--shadow-color)18%); background-size:200% auto; background-clip:text; color:transparent; }
  .loader .text:nth-child(4) span { background: linear-gradient(to right, var(--text-color)20%, var(--shadow-color)23%); background-size:200% auto; background-clip:text; color:transparent; }
  .loader .text:nth-child(6) span { background: linear-gradient(to right, var(--shadow-color)29%, var(--text-color)32%); background-size:200% auto; background-clip:text; color:transparent; }
  .loader .text:nth-child(7) span { background: linear-gradient(to right, var(--shadow-color)34%, var(--text-color)37%); background-size:200% auto; background-clip:text; color:transparent; }
  .loader .text:nth-child(8) span { background: linear-gradient(to right, var(--shadow-color)39%, var(--text-color)42%); background-size:200% auto; background-clip:text; color:transparent; }
  .loader .text:nth-child(9) span { background: linear-gradient(to right, var(--shadow-color)45%, var(--text-color)48%); background-size:200% auto; background-clip:text; color:transparent; }

  @keyframes scrolling { 0% {transform:translateX(-100%);} 100% {transform:translateX(100%);} }
  @keyframes shadow { 0% {background-position:-98% 0;} 100% {background-position:102% 0;} }

  .image-section {
    position: absolute;
    top: 50vh;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    align-items: center;
    gap: 40px;
    max-width: 900px;
    width: 90%;
    z-index: 2;
  }

  .image-container {
    flex: 1;
    position: relative;
  }

  .rug-image {
    width: 100%;
    max-width: 400px;
    height: auto;
    border-radius: 15px;
    box-shadow: 0 0 30px rgba(255, 255, 255, 0.1);
    border: 2px solid rgba(255, 255, 255, 0.1);
  }

  .text-content {
    flex: 1;
    color: white;
    text-align: left;
  }

  .text-content h2 {
    font-size: 3rem;
    font-weight: 800;
    margin: 0 0 20px 0;
    background: linear-gradient(45deg, #fff, #aaa);
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    position: relative;
  }

  .arrow {
    position: absolute;
    right: -60px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 3rem;
    color: #fff;
    animation: point 2s ease-in-out infinite;
  }

  @keyframes point {
    0%, 100% { transform: translateY(-50%) translateX(0); }
    50% { transform: translateY(-50%) translateX(10px); }
  }

  .purchase-section {
    position: absolute;
    top: 100vh;
    left: 50%;
    transform: translateX(-50%);
    text-align: center;
    width: 90%;
    max-width: 900px;
    z-index: 2;
    padding: 40px 0;
  }

  .purchase-btn {
    cursor: pointer;
    display: block;
    padding: 8px 20px;
    border-radius: 6px;
    background: black;
    color: white;
    font-size: 2.25rem;
    font-weight: bold;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    transition: all 0.3s ease;
    border: none;
    margin: 0 auto;
  }

  .purchase-btn:hover {
    transform: scale(1.1);
  }

  .purchase-btn:active {
    transform: scale(0.9);
  }

  .purchase-btn span {
    display: inline-block;
    transition: text-shadow 0.3s ease;
  }

  .purchase-btn:hover span {
    text-shadow: 3px 3px 6px rgba(255, 255, 255, 0.7);
  }

  .button-subtitle {
    color: white;
    margin-top: 15px;
    font-size: 1.1rem;
    opacity: 0.8;
  }

  .cards-section {
    position: absolute;
    top: 140vh;
    left: 50%;
    transform: translateX(-50%);
    width: 90%;
    max-width: 1200px;
    display: flex;
    justify-content: center;
    gap: 40px;
    flex-wrap: wrap;
    padding: 40px 0;
    opacity: 1;
    z-index: 2;
  }

  .outer {
    width: 300px;
    height: 250px;
    border-radius: 10px;
    padding: 1px;
    background: radial-gradient(circle 230px at 0% 0%, #ffffff, #0c0d0d);
    position: relative;
    opacity: 1;
    transform: translateY(0);
  }

  .dot {
    width: 5px;
    aspect-ratio: 1;
    position: absolute;
    background-color: #fff;
    box-shadow: 0 0 10px #ffffff;
    border-radius: 100px;
    z-index: 2;
    right: 10%;
    top: 10%;
    animation: moveDot 6s linear infinite;
  }

  @keyframes moveDot {
    0%, 100% { top: 10%; right: 10%; }
    25% { top: 10%; right: calc(100% - 35px); }
    50% { top: calc(100% - 30px); right: calc(100% - 35px); }
    75% { top: calc(100% - 30px); right: 10%; }
  }

  .card {
    z-index: 1;
    width: 100%;
    height: 100%;
    border-radius: 9px;
    border: solid 1px #202222;
    background-size: 20px 20px;
    background: radial-gradient(circle 280px at 0% 0%, #444444, #0c0d0d);
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    flex-direction: column;
    color: #fff;
  }

  .ray {
    width: 220px;
    height: 45px;
    border-radius: 100px;
    position: absolute;
    background-color: #c7c7c7;
    opacity: 0.4;
    box-shadow: 0 0 50px #fff;
    filter: blur(10px);
    transform-origin: 10%;
    top: 0%;
    left: 0;
    transform: rotate(40deg);
  }

  .card .text {
    font-weight: bolder;
    font-size: 4rem;
    background: linear-gradient(45deg, #000000 4%, #fff, #000);
    background-clip: text;
    color: transparent;
  }

  .card > div:not(.text):not(.ray):not(.line) {
    font-size: 1.2rem;
    margin-top: 10px;
    opacity: 0.9;
  }

  .line {
    width: 100%;
    height: 1px;
    position: absolute;
    background-color: #2c2c2c;
  }

  .topl {
    top: 10%;
    background: linear-gradient(90deg, #888888 30%, #1d1f1f 70%);
  }

  .bottoml {
    bottom: 10%;
  }

  .leftl {
    left: 10%;
    width: 1px;
    height: 100%;
    background: linear-gradient(180deg, #747474 30%, #222424 70%);
  }

  .rightl {
    right: 10%;
    width: 1px;
    height: 100%;
  }

  .scroll-indicator {
    position: fixed;
    bottom: 60px;
    left: 50%;
    transform: translateX(-50%);
    color: rgba(255, 255, 255, 0.7);
    font-size: 14px;
    text-align: center;
    z-index: 10;
    opacity: 1;
  }

  .scroll-indicator::after {
    content: "‚Üì";
    display: block;
    margin-top: 5px;
    font-size: 20px;
    animation: bounce 2s infinite;
  }

  @keyframes bounce {
    0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
    40% { transform: translateY(-10px); }
    60% { transform: translateY(-5px); }
  }

  /* Modal Styles - UPDATED FOR SCROLLING */
  .modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    justify-content: center;
    align-items: flex-start; /* Changed from center to flex-start */
    z-index: 1000;
    backdrop-filter: blur(10px);
    overflow-y: auto; /* Enable scrolling */
    padding: 20px 0; /* Add padding for better mobile */
  }

  .modal-content {
    background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
    padding: 40px;
    border-radius: 20px;
    max-width: 500px;
    width: 90%;
    color: white;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    border: 1px solid rgba(255, 255, 255, 0.1);
    margin: 20px 0; /* Add margin for spacing */
    max-height: 90vh; /* Limit height */
    overflow-y: auto; /* Enable scrolling inside modal */
  }

  .modal-header {
    text-align: center;
    margin-bottom: 30px;
  }

  .modal-header h2 {
    font-size: 2.5rem;
    margin: 0;
    background: linear-gradient(45deg, #fff, #aaa);
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .plans-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 15px;
    margin-bottom: 30px;
  }

  .plan-option {
    background: rgba(255, 255, 255, 0.05);
    padding: 20px;
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .plan-option:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: translateY(-2px);
  }

  .plan-option.selected {
    background: rgba(255, 255, 255, 0.15);
    border-color: #fff;
  }

  .plan-name {
    font-size: 1.3rem;
    font-weight: bold;
    margin-bottom: 5px;
  }

  .plan-price {
    font-size: 1.1rem;
    opacity: 0.8;
  }

  .payment-section {
    background: rgba(255, 255, 255, 0.05);
    padding: 25px;
    border-radius: 12px;
    margin-top: 20px;
  }

  .wallet-address {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 20px;
    padding: 15px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 8px;
    font-family: monospace;
    font-size: 0.9rem;
  }

  .wallet-icon {
    width: 32px;
    height: 32px;
    flex-shrink: 0;
  }

  .address-arrow {
    font-size: 1.2rem;
    opacity: 0.7;
  }

  .address-text {
    flex: 1;
    word-break: break-all;
  }

  .input-group {
    margin-bottom: 20px;
  }

  .input-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
  }

  .input-group input {
    width: 100%;
    padding: 12px;
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    background: rgba(0, 0, 0, 0.3);
    color: white;
    font-size: 1rem;
  }

  .payment-buttons {
    display: flex;
    gap: 10px;
    margin-top: 25px; /* Added space above buttons */
    padding-top: 15px; /* Added padding */
    border-top: 1px solid rgba(255, 255, 255, 0.1); /* Visual separator */
  }

  .payment-btn {
    flex: 1;
    padding: 15px; /* Increased padding */
    border: none;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 1rem;
  }

  .payment-btn.primary {
    background: #000;
    color: white;
  }

  .payment-btn.secondary {
    background: rgba(255, 255, 255, 0.1);
    color: white;
  }

  .payment-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none !important;
  }

  .payment-btn:hover:not(:disabled) {
    transform: translateY(-2px);
  }

  .notification {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 15px 25px;
    border-radius: 8px;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    z-index: 1001;
    transform: translateX(400px);
    transition: transform 0.3s ease;
    font-weight: 500;
  }

  .notification.success {
    background: #10b981;
    color: white;
  }

  .notification.error {
    background: #ef4444;
    color: white;
  }

  .notification.info {
    background: #3b82f6;
    color: white;
  }

  .notification.warning {
    background: #f59e0b;
    color: white;
  }

  .notification.show {
    transform: translateX(0);
  }

  .validation-status {
    margin: 15px 0;
    padding: 12px;
    border-radius: 8px;
    text-align: center;
    font-weight: bold;
  }
  
  .status-pending {
    background: rgba(255, 193, 7, 0.2);
    border: 1px solid #ffc107;
    color: #ffc107;
  }
  
  .status-success {
    background: rgba(40, 167, 69, 0.2);
    border: 1px solid #28a745;
    color: #28a745;
  }
  
  .status-error {
    background: rgba(220, 53, 69, 0.2);
    border: 1px solid #dc3545;
    color: #dc3545;
  }
  
  .amount-display {
    font-size: 1.1rem;
    font-weight: bold;
    margin: 10px 0;
    color: #fff;
    text-align: center;
  }
  
  .sol-amount {
    color: #00ffbd;
    font-family: monospace;
  }

  .loading-dots {
    display: inline-block;
  }

  .loading-dots::after {
    content: '';
    animation: dots 1.5s steps(5, end) infinite;
  }

  @keyframes dots {
    0%, 20% { content: '.'; }
    40% { content: '..'; }
    60% { content: '...'; }
    80%, 100% { content: ''; }
  }

  @media (max-width: 768px) {
    .image-section {
      flex-direction: column;
      text-align: center;
      gap: 20px;
    }
    
    .arrow {
      position: relative;
      right: auto;
      top: auto;
      transform: none;
      margin: 10px 0;
    }
    
    .text-content h2 {
      font-size: 2rem;
    }
    
    .purchase-btn {
      padding: 8px 20px;
      font-size: 2rem;
    }
    
    .modal-content {
      padding: 25px 20px; /* Reduced padding on mobile */
      margin: 10px 0;
    }
    
    .modal-overlay {
      padding: 10px 0; /* Reduced padding on mobile */
      align-items: flex-start;
    }
    
    .payment-buttons {
      flex-direction: column; /* Stack buttons on mobile */
      gap: 10px;
    }
    
    .payment-btn {
      padding: 12px; /* Slightly smaller on mobile */
    }
  }

  /* Ensure modal is always scrollable */
  @media (max-height: 700px) {
    .modal-content {
      max-height: 85vh;
      overflow-y: auto;
    }
  }
</style>
</head>
<body>
  <div class="container">
    <div class="loader">
      <div class="text"><span>Echo Rug</span></div>
      <div class="text"><span>Echo Rug</span></div>
      <div class="text"><span>Echo Rug</span></div>
      <div class="text"><span>Echo Rug</span></div>
      <div class="text"><span>Echo Rug</span></div>
      <div class="text"><span>Echo Rug</span></div>
      <div class="text"><span>Echo Rug</span></div>
      <div class="text"><span>Echo Rug</span></div>
      <div class="text"><span>Echo Rug</span></div>
    </div>

    <div class="image-section">
      <div class="text-content">
        <h2>
          All From Rugging
          <span class="arrow">‚Üí</span>
        </h2>
      </div>
      <div class="image-container">
        <img src="https://i.pinimg.com/736x/4d/f1/b3/4df1b3004ae97ac9e61e30fa40f0590a.jpg" alt="Rugging" class="rug-image">
      </div>
    </div>

    <div class="purchase-section">
      <button class="purchase-btn" id="purchaseBtn">
        <span>Purchase</span>
      </button>
      <p class="button-subtitle">Start earning today with Echo Rug</p>
    </div>

    <div class="cards-section">
      <div class="outer">
        <div class="dot"></div>
        <div class="card">
          <div class="ray"></div>
          <div class="text">1k</div>
          <div>Liquidity</div>
          <div class="line topl"></div>
          <div class="line leftl"></div>
          <div class="line bottoml"></div>
          <div class="line rightl"></div>
        </div>
      </div>
      <div class="outer">
        <div class="dot"></div>
        <div class="card">
          <div class="ray"></div>
          <div class="text">7M</div>
          <div>Supply</div>
          <div class="line topl"></div>
          <div class="line leftl"></div>
          <div class="line bottoml"></div>
          <div class="line rightl"></div>
        </div>
      </div>
      <div class="outer">
        <div class="dot"></div>
        <div class="card">
          <div class="ray"></div>
          <div class="text">500+</div>
          <div>Tokens Launched</div>
          <div class="line topl"></div>
          <div class="line leftl"></div>
          <div class="line bottoml"></div>
          <div class="line rightl"></div>
        </div>
      </div>
    </div>

    <div class="scroll-indicator">Scroll for more info</div>
  </div>

  <script>
    let selectedPlan = null;
    const plans = {
      '1day': { name: '1 Day Plan', price: 13 },
      '1week': { name: '1 Week Plan', price: 30 },
      '1month': { name: '1 Month Plan', price: 60 },
      '1year': { name: '1 Year Plan', price: 200 }
    };

    const walletAddress = '41kJjyprB4c8mXTCNTemNoE9rikS3pZ8GxS2Db18MRML';

    // Modern crypto wallet SVG icon
    const walletSVG = `
      <svg class="wallet-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M19 7H5C3.89543 7 3 7.89543 3 9V19C3 20.1046 3.89543 21 5 21H19C20.1046 21 21 20.1046 21 19V9C21 7.89543 20.1046 7 19 7Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M16 7V5C16 3.89543 15.1046 3 14 3H5C3.89543 3 3 3.89543 3 5V9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M16 12H16.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M19 12H19.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M16 15H16.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M19 15H19.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M16 18H16.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M19 18H19.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    `;

    // Get current SOL price in USD
    async function getSolanaPrice() {
      try {
        const response = await axios.get('https://api.coingecko.com/api/v3/simple/price?ids=solana&vs_currencies=usd', {
          timeout: 5000
        });
        return response.data.solana.usd;
      } catch (error) {
        console.warn('Price API failed, using fallback price of $100');
        return 100; // Fallback price
      }
    }

    document.getElementById('purchaseBtn').addEventListener('click', function() {
      showPlansModal();
    });

    function showPlansModal() {
      const modal = document.createElement('div');
      modal.className = 'modal-overlay';
      modal.innerHTML = `
        <div class="modal-content">
          <div class="modal-header">
            <h2>Choose Your Plan</h2>
            <p style="opacity: 0.8; margin-top: 10px;">Real blockchain validation - checks actual SOL payments</p>
          </div>
          
          <div class="plans-grid">
            ${Object.entries(plans).map(([key, plan]) => `
              <div class="plan-option" data-plan="${key}">
                <div class="plan-name">${plan.name}</div>
                <div class="plan-price">$${plan.price} USD</div>
              </div>
            `).join('')}
          </div>

          <div class="payment-section" id="paymentSection" style="display: none;">
            <div class="wallet-address">
              <div class="wallet-icon">${walletSVG}</div>
              <div class="address-arrow">‚Üí</div>
              <div class="address-text">${walletAddress}</div>
            </div>
            
            <div class="amount-display" id="solAmountDisplay">
              Calculating SOL amount...
            </div>
            
            <div class="validation-status status-pending" id="validationStatus" style="display: none;">
              Ready to validate real payment
            </div>
            
            <div class="input-group">
              <label for="solanaAddress">Your Solana Address:</label>
              <input type="text" id="solanaAddress" placeholder="Enter your Solana wallet address">
            </div>
            
            <div class="input-group">
              <label for="transactionHash">Transaction Hash (Optional):</label>
              <input type="text" id="transactionHash" placeholder="Enter TX hash for faster verification">
            </div>
            
            <div class="payment-buttons">
              <button class="payment-btn secondary" id="backToPlans">Back to Plans</button>
              <button class="payment-btn primary" id="validatePayment">Validate Real Payment</button>
            </div>
            
            <div style="margin-top: 15px; font-size: 0.9rem; opacity: 0.7; text-align: center;">
              üí° Send EXACT SOL amount shown above
            </div>
          </div>
        </div>
      `;

      document.body.appendChild(modal);

      // Auto-scroll to bottom when payment section opens
      const paymentSection = modal.querySelector('#paymentSection');
      const observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
          if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
            if (paymentSection.style.display === 'block') {
              setTimeout(() => {
                modal.scrollTop = modal.scrollHeight;
              }, 100);
            }
          }
        });
      });
      observer.observe(paymentSection, { attributes: true });

      // Plan selection
      modal.querySelectorAll('.plan-option').forEach(option => {
        option.addEventListener('click', async function() {
          modal.querySelectorAll('.plan-option').forEach(opt => opt.classList.remove('selected'));
          this.classList.add('selected');
          selectedPlan = this.dataset.plan;
          
          // Calculate and display SOL amount
          const solAmountDisplay = modal.querySelector('#solAmountDisplay');
          solAmountDisplay.innerHTML = 'Calculating SOL amount<span class="loading-dots"></span>';
          
          try {
            const solPrice = await getSolanaPrice();
            const requiredSOL = (plans[selectedPlan].price / solPrice).toFixed(6);
            solAmountDisplay.innerHTML = `Send: <span class="sol-amount">${requiredSOL} SOL</span><br><small>($${plans[selectedPlan].price} USD at $${solPrice.toFixed(2)}/SOL)</small>`;
            
            // Show validation status
            const validationStatus = modal.querySelector('#validationStatus');
            validationStatus.style.display = 'block';
            validationStatus.className = 'validation-status status-pending';
            validationStatus.innerHTML = 'üí∞ Send EXACT amount above to validate';
            
          } catch (error) {
            solAmountDisplay.innerHTML = 'Error calculating amount. Please refresh.';
          }
          
          modal.querySelector('#paymentSection').style.display = 'block';
          
          // Scroll to show the validate button
          setTimeout(() => {
            modal.scrollTop = modal.scrollHeight;
          }, 300);
        });
      });

      // Back to plans
      modal.querySelector('#backToPlans').addEventListener('click', function() {
        modal.querySelector('#paymentSection').style.display = 'none';
        modal.querySelectorAll('.plan-option').forEach(opt => opt.classList.remove('selected'));
        selectedPlan = null;
      });

      // Validate payment
      modal.querySelector('#validatePayment').addEventListener('click', async function() {
        const solanaAddress = modal.querySelector('#solanaAddress').value.trim();
        const transactionHash = modal.querySelector('#transactionHash').value.trim();
        
        if (!selectedPlan) {
          showNotification('Please select a plan first!', 'error');
          return;
        }
        
        if (!solanaAddress) {
          showNotification('Please enter your Solana address!', 'error');
          return;
        }

        // Validate Solana address format
        try {
          new solanaWeb3.PublicKey(solanaAddress);
        } catch (e) {
          showNotification('Invalid Solana address format!', 'error');
          return;
        }

        // Disable button during validation
        const validateBtn = modal.querySelector('#validatePayment');
        const validationStatus = modal.querySelector('#validationStatus');
        validateBtn.disabled = true;
        validateBtn.textContent = 'Checking Blockchain...';
        validationStatus.className = 'validation-status status-pending';
        validationStatus.innerHTML = 'üîç Connecting to Solana network...';

        try {
          const solPrice = await getSolanaPrice();
          const requiredSOL = plans[selectedPlan].price / solPrice;
          const tolerance = 0.0001; // Small tolerance for price fluctuations
          
          await validateRealPayment(solanaAddress, transactionHash, requiredSOL, tolerance, plans[selectedPlan].price);
          document.body.removeChild(modal);
        } catch (error) {
          validationStatus.className = 'validation-status status-error';
          validationStatus.innerHTML = `‚ùå ${error.message}`;
          showNotification('Validation failed: ' + error.message, 'error');
        } finally {
          validateBtn.disabled = false;
          validateBtn.textContent = 'Validate Real Payment';
        }
      });

      // Close modal when clicking outside
      modal.addEventListener('click', function(e) {
        if (e.target === modal) {
          document.body.removeChild(modal);
        }
      });
    }

    async function validateRealPayment(userAddress, transactionHash, requiredSOL, tolerance, usdAmount) {
      showNotification('üîó Connecting to Solana mainnet...', 'info');
      
      const connection = new solanaWeb3.Connection(
        solanaWeb3.clusterApiUrl('mainnet-beta'),
        'confirmed'
      );

      const ourPublicKey = new solanaWeb3.PublicKey(walletAddress);
      const userPublicKey = new solanaWeb3.PublicKey(userAddress);

      showNotification(`üí∞ Looking for ${requiredSOL.toFixed(6)} SOL payment...`, 'info');

      let paymentFound = false;
      let attempts = 0;
      const maxAttempts = 12; // Check for 60 seconds

      // If transaction hash provided, check that first
      if (transactionHash) {
        showNotification(`üîé Checking transaction: ${transactionHash.substring(0, 12)}...`, 'info');
        try {
          const tx = await connection.getTransaction(transactionHash);
          if (tx && await isValidPayment(tx, userPublicKey, ourPublicKey, requiredSOL, tolerance)) {
            paymentFound = true;
            showRealSuccess(usdAmount, requiredSOL, transactionHash);
            return;
          } else {
            showNotification('‚ùå Transaction found but payment invalid', 'error');
          }
        } catch (e) {
          showNotification('‚ùå Transaction not found, scanning blockchain...', 'warning');
        }
      }

      // Scan recent transactions
      while (attempts < maxAttempts && !paymentFound) {
        attempts++;
        
        try {
          showNotification(`üì° Scanning blockchain (${attempts}/${maxAttempts})<span class="loading-dots"></span>`, 'info');
          
          // Get recent signatures for our wallet
          const signatures = await connection.getSignaturesForAddress(ourPublicKey, {limit: 30});
          
          for (const signature of signatures) {
            try {
              const tx = await connection.getTransaction(signature.signature);
              
              if (tx && await isValidPayment(tx, userPublicKey, ourPublicKey, requiredSOL, tolerance)) {
                paymentFound = true;
                showRealSuccess(usdAmount, requiredSOL, signature.signature);
                return;
              }
            } catch (e) {
              continue;
            }
          }

          if (!paymentFound) {
            // Wait 5 seconds before next attempt
            await new Promise(resolve => setTimeout(resolve, 5000));
          }
        } catch (error) {
          console.error('Scan error:', error);
          await new Promise(resolve => setTimeout(resolve, 3000));
        }
      }

      if (!paymentFound) {
        throw new Error(`No payment of ${requiredSOL.toFixed(6)} SOL found from your address. Please send exact amount and try again.`);
      }
    }

    async function isValidPayment(tx, userPublicKey, ourPublicKey, requiredSOL, tolerance) {
      if (!tx.meta || tx.meta.err) return false;

      // Check if user is a signer
      const userIsSigner = tx.transaction.signatures.some(sig => 
        sig.toString() === userPublicKey.toString()
      );
      
      if (!userIsSigner) return false;

      // Find our account index in the transaction
      const ourAccountIndex = tx.transaction.message.accountKeys.findIndex(
        key => key.toString() === ourPublicKey.toString()
      );
      
      if (ourAccountIndex === -1) return false;

      // Calculate amount received (in lamports, then convert to SOL)
      const preBalance = tx.meta.preBalances[ourAccountIndex];
      const postBalance = tx.meta.postBalances[ourAccountIndex];
      const receivedLamports = postBalance - preBalance;
      const receivedSOL = receivedLamports / solanaWeb3.LAMPORTS_PER_SOL;

      // Check if amount matches within tolerance
      const amountMatch = Math.abs(receivedSOL - requiredSOL) <= tolerance;
      
      if (amountMatch) {
        console.log(`‚úÖ REAL PAYMENT VALIDATED: ${receivedSOL} SOL from ${userPublicKey.toString()}`);
        return true;
      } else {
        console.log(`‚ùå Wrong amount: ${receivedSOL} SOL received, expected ${requiredSOL} SOL`);
      }

      return false;
    }

    function showRealSuccess(usdAmount, solAmount, txHash) {
      showNotification('‚úÖ REAL PAYMENT CONFIRMED! üéâ', 'success');
      setTimeout(() => {
        showNotification(`üí∞ $${usdAmount} (${solAmount.toFixed(6)} SOL) validated!`, 'success');
      }, 1500);
      setTimeout(() => {
        showNotification(`üì¶ Access granted! TX: ${txHash.substring(0, 12)}...`, 'success');
      }, 3000);
    }

    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      notification.innerHTML = message;
      
      document.body.appendChild(notification);
      
      setTimeout(() => notification.classList.add('show'), 100);
      
      setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => {
          if (notification.parentNode) {
            document.body.removeChild(notification);
          }
        }, 300);
      }, 5000);
    }
  </script>
</body>
</html>